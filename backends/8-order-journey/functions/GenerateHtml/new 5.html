<head><link rel='stylesheet' type='text/css' href='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/css/style.css'> <link rel='stylesheet' type='text/css' href='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/css/fa.css'> <style>p{font-size:20px !important;} img{width:100%:} </style></head> <body> <div style='text-align:center'> <a href='https://order.serverlesscoffee.com'><img src='https://da-public-assets.s3.amazonaws.com/serverlesspresso/images/serverlesspresso-large.png'></a> </div> <section style='padding:20px;'><p style=''>Your order was orchestrated by this AWS Step Functions workflow:<br><img src='https://da-public-assets.s3.amazonaws.com/serverlesspresso/images/order_processor_cancellation.png'><p></section> <section style='padding:20px;'><h2 style=''>Events:</h2><p style=''>These are the events that choreographed the order:</p></section> <section class='cd-timeline js-cd-timeline'> <div class='container max-width-lg cd-timeline__container'> <div class='cd-timeline__block'> <div class='cd-timeline__img cd-timeline__img--picture'> <img src='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/img/cd-icon-picture.svg' alt='Picture'> </div> <!-- cd-timeline__img --> <div class='cd-timeline__content text-component'> <h2 style=''>NewOrder</h2> <p style='' class='color-contrast-medium'>A Lambda function is invoked by a POST request to Amazon API Gateway. The Lambda function, Takes the token ID from the QR code scan and checks it against the valid token ID's stored in a DynamoDB database. If Valid, a new Step Functions Workflow is started, this workflow ochestrates various AWS services to move the order along to completion.</p> <p><img style='width:100%;' src='https://da-public-assets.s3.amazonaws.com/serverlesspresso/images/ValidatorNewOrder.png'></p> <div class='flex justify-between items-center'> <span class='cd-timeline__date'><h2 style=''>14:31:53</h2></span> </div> </div> <!-- cd-timeline__content --> </div> <!-- cd-timeline__block --> <div class='cd-timeline__block'> <div class='cd-timeline__img cd-timeline__img--picture'> <img src='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/img/cd-icon-picture.svg' alt='Picture'> </div> <!-- cd-timeline__img --> <div class='cd-timeline__content text-component'> <h2 style=''>WorkflowStarted</h2> <p style='' class='color-contrast-medium'>The Step Functions workflow checks that the shop is open and has capcity to serve your order. Now, the workflow pauses. It emits an event with a unique 'task token', this event envoked a Lambda function that persists the token to an Amazon DynamoDB table, along with your order ID.</p> <p><img style='width:100%;' src='https://da-public-assets.s3.amazonaws.com/serverlesspresso/images/OrderProcessorWorkflowStarted.png'></p> <div class='flex justify-between items-center'> <span class='cd-timeline__date'><h2 style=''>14:31:55</h2></span> </div> </div> <!-- cd-timeline__content --> </div> <!-- cd-timeline__block --> <div class='cd-timeline__block'> <div class='cd-timeline__img cd-timeline__img--picture'> <img src='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/img/cd-icon-picture.svg' alt='Picture'> </div> <!-- cd-timeline__img --> <div class='cd-timeline__content text-component'> <h2 style=''>WaitingCompletion</h2> <p style='' class='color-contrast-medium'>You pressed 'submit order', this sends an HTTP POST request to a Lambda function via Amazon API Gateway. The Lambda fucntion retrives the 'Task Token' from dynamo DB and resumes the workflow. The workflow then invokes a Lambda function to generate your order number.  The Step Functions workflow then pauses once again and emits an event with a 'Task Token'.</p> <p><img style='width:100%;' src='https://da-public-assets.s3.amazonaws.com/serverlesspresso/images/OrderProcessorWaitingCompletion.png'></p> <div class='flex justify-between items-center'> <span class='cd-timeline__date'><h2 style=''>14:32:04</h2></span> </div> </div> <!-- cd-timeline__content --> </div> <!-- cd-timeline__block --> <div class='cd-timeline__block'> <div class='cd-timeline__img cd-timeline__img--picture'> <img src='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/img/cd-icon-picture.svg' alt='Picture'> </div> <!-- cd-timeline__img --> <div class='cd-timeline__content text-component'> <h2 style=''>WaitingCompletion</h2> <p style='' class='color-contrast-medium'>The 'task token' is persisted in an Amazon DynamoDB table. The Task Token is later used to resume the workflow when the barista completes or cancels the order.</p> <p><img style='width:100%;' src='https://da-public-assets.s3.amazonaws.com/serverlesspresso/images/OrderManagerWaitingCompletion.png'></p> <div class='flex justify-between items-center'> <span class='cd-timeline__date'><h2 style=''>14:32:05</h2></span> </div> </div> <!-- cd-timeline__content --> </div> <!-- cd-timeline__block --> <div class='cd-timeline__block'> <div class='cd-timeline__img cd-timeline__img--picture'> <img src='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/img/cd-icon-picture.svg' alt='Picture'> </div> <!-- cd-timeline__img --> <div class='cd-timeline__content text-component'> <h2 style=''>OrderCancelled</h2> <p style='' class='color-contrast-medium'>undefined</p> <p><img style='width:100%;' src='https://da-public-assets.s3.amazonaws.com/serverlesspresso/images/OrderManagerOrderCancelled.png'></p> <div class='flex justify-between items-center'> <span class='cd-timeline__date'><h2 style=''>14:32:39</h2></span> </div> </div> <!-- cd-timeline__content --> </div> <!-- cd-timeline__block --> <div class='cd-timeline__block'> <!-- ... --> </div> <!-- cd-timeline__block --> </div> <div style='text-align:center'> <a style='width:50% !important; padding:10px; font-size:30px;' data-size='large' href='https://twitter.com/intent/tweet?text=I%20Just%20ordered%20a%20coffee%20using sererlesspresso!%20&url=https://serverlessland.com/sls-order-journey?orderId=undefined&hashtags=serverlesspresso' class='twitter-share-button btn btn--subtle'> Share </a> </div> </section> <!-- cd-timeline --> <script src='https://serverlesspresso-order-journey-journeybucket-1lc9wg7eac1f4.s3.us-west-2.amazonaws.com/assets/js/main.js'></script></body>